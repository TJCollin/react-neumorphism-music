{"version":3,"sources":["store/actions.ts","components/Header/index.tsx","components/NavTabs/index.tsx","components/Player/MiniPlayer/index.tsx","components/Player/SongList/index.tsx","components/Player/index.tsx","components/Toast/index.tsx","layouts/HomeLayout/index.tsx","utils/format.ts","components/Scroll/index.tsx","components/Scroll/index.module.scss","components/Header/index.module.scss","components/NavTabs/index.module.scss","components/Player/MiniPlayer/index.module.scss","components/Player/SongList/index.module.scss","components/Toast/index.module.scss"],"names":["toggleToastAction","show","payload","type","TOGGLE_TOAST","Header","dispatch","useDispatch","handleClick","className","styles","onClick","icon","memo","NavTabs","props","to","activeClassName","MiniPlayer","song","playStatus","CSSTransition","in","undefined","timeout","classNames","unmountOnExit","src","album","picUrl","width","height","alt","name","singers","map","item","join","console","log","changePlayStatusAction","changeShowSongListAction","SongList","songList","index","useState","canTouch","setCanTouch","handleScroll","useCallback","pos","y","startY","distance","initialed","touchInfo","setTouchInfo","listRef","useRef","setShow","onEnterCB","current","style","onEnteringCB","onExitCB","onExitingCB","onExitedCB","appear","onEnter","onEntering","onExit","onExiting","onExited","e","stopPropagation","ref","onTouchStart","nativeEvent","touches","pageY","onTouchMove","dis","transform","onTouchEnd","transition","Scroll","onScroll","idx","formatSingerName","btnType","deleteSongAction","handleDeleteClick","id","Player","useSelector","state","curIdx","player","currentIndex","status","showSongList","curSong","setCurSong","useEffect","length","preSong","newSong","audioDom","audioRef","formatSongUrl","play","pause","autoPlay","Toast","showToast","toast","toastText","hideToast","timer","setTimeout","clearTimeout","Number","title","onClose","HomeLayout","route","renderRoutes","routes","singerList","forwardRef","direction","click","children","bounceTop","bounceBottom","bounceLeft","bounceRight","pullDownLoading","pullUpLoading","onPullDown","onPullUp","bScroll","setBScroll","scrollRef","scroll","BScroll","probeType","scrollX","scrollY","tap","bounce","top","bottom","left","right","on","off","refresh","module","exports"],"mappings":"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","file":"static/js/5.86ea77af.chunk.js","sourcesContent":["import { TOGGLE_TOAST } from \"./actionTypes\";\n\nexport const toggleToastAction = (\n  show: boolean,\n  payload: string = \"暂未开发\"\n) => {\n  return {\n    type: TOGGLE_TOAST,\n    payload: payload,\n    show: show,\n  };\n};\n","import React, { FC, memo } from \"react\";\nimport styles from \"./index.module.scss\";\nimport { Button, Icon } from \"collin-ui\";\nimport { toggleToastAction } from \"../../store/actions\";\nimport { useDispatch } from \"react-redux\";\n\nconst Header = () => {\n  const dispatch = useDispatch();\n  const handleClick = () => {\n    dispatch(toggleToastAction(true, \"功能暂未开发哟\"));\n  };\n\n  return (\n    <header className={styles[\"header\"]}>\n      <Button className={styles[\"menu\"]} onClick={handleClick}>\n        <Icon icon=\"list\"></Icon>\n      </Button>\n      <Button className={styles[\"search\"]} onClick={handleClick}>\n        <Icon icon=\"search\"></Icon>\n      </Button>\n    </header>\n  );\n};\n\nexport default memo(Header);\n","import React, { FC, memo, useState } from \"react\";\nimport { NavLink, withRouter } from \"react-router-dom\";\n\nimport styles from \"./index.module.scss\";\n\nconst NavTabs: FC = (props) => {\n  return (\n    <div className={styles[\"nav-tabs\"]}>\n      <NavLink to=\"/recommend\" activeClassName={styles[\"actived\"]}>\n        <span>推荐</span>\n      </NavLink>\n      <NavLink to=\"/singers\" activeClassName={styles[\"actived\"]}>\n        <span>歌手</span>\n      </NavLink>\n      <NavLink to=\"/rank\" activeClassName={styles[\"actived\"]}>\n        <span>排行榜</span>\n      </NavLink>\n    </div>\n  );\n};\n\nexport default memo(NavTabs);\n","import { Button, Icon } from \"collin-ui\";\nimport React, { FC, memo, useEffect, useState } from \"react\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { CSSTransition } from \"react-transition-group\";\nimport { StoreState } from \"../../../store\";\nimport { Song } from \"../../../typings\";\nimport {\n  changePlayStatusAction,\n  changeShowSongListAction,\n} from \"../store/actions\";\nimport styles from \"./index.module.scss\";\nimport classNames from \"classnames\";\n\nexport interface MiniPlayerProps {\n  playStatus: boolean;\n  song?: Song;\n}\n\nconst MiniPlayer: FC<MiniPlayerProps> = (props) => {\n  const { song, playStatus } = props;\n  const dispatch = useDispatch();\n  const handlePlayButtonClick = () => {\n    console.log(\"play\", !playStatus);\n    dispatch(changePlayStatusAction(!playStatus));\n  };\n\n  const handleListButtonClick = () => {\n    dispatch(changeShowSongListAction(true));\n  };\n\n  return (\n    <CSSTransition\n      in={song !== undefined}\n      timeout={400}\n      classNames=\"mini\"\n      unmountOnExit\n    >\n      <div className={styles[\"mini-player\"]}>\n        <div\n          className={classNames(\n            styles[\"img-wrap\"],\n            !playStatus && styles[\"pause\"]\n          )}\n        >\n          <img\n            src={song?.album.picUrl + \"?param=100y100\"}\n            width=\"40\"\n            height=\"40\"\n            alt=\"\"\n          />\n        </div>\n        <div className={styles[\"text\"]}>\n          <p className={styles[\"name\"]}>{song?.name}</p>\n          <p className={styles[\"singer\"]}>\n            {song?.singers.map((item) => item.name).join(\" / \")}\n          </p>\n        </div>\n        <div className={styles[\"control\"]}>\n          <Button\n            className={styles[\"control-button\"]}\n            onClick={handlePlayButtonClick}\n          >\n            <Icon icon={playStatus ? \"pause\" : \"play\"} />\n          </Button>\n          <Button\n            className={styles[\"control-list\"]}\n            onClick={handleListButtonClick}\n          >\n            <Icon icon=\"list-ul\" />\n          </Button>\n        </div>\n      </div>\n    </CSSTransition>\n  );\n};\n\nexport default memo(MiniPlayer);\n","import React, {\n  FC,\n  memo,\n  useCallback,\n  useState,\n  TouchEvent,\n  MouseEvent,\n  useRef,\n} from \"react\";\nimport { CSSTransition } from \"react-transition-group\";\nimport { Song } from \"../../../typings\";\nimport styles from \"./index.module.scss\";\nimport Scroll, { Position } from \"../../Scroll\";\nimport { useDispatch } from \"react-redux\";\nimport { changeShowSongListAction, deleteSongAction } from \"../store/actions\";\nimport { Button, Icon } from \"collin-ui\";\nimport { formatSingerName } from \"../../../utils/format\";\nimport classNames from \"classnames\";\n\nexport interface SongListProps {\n  songList: Song[];\n  index: number;\n}\n\nconst SongList: FC<SongListProps> = (props) => {\n  const { songList, index } = props;\n  const [canTouch, setCanTouch] = useState(true);\n  const handleScroll = useCallback((pos: Position) => {\n    setCanTouch(pos.y === 0);\n  }, []);\n  const [touchInfo, setTouchInfo] = useState({\n    startY: 0,\n    distance: 0,\n    // initial 用于区分是点击还是touch时间\n    initialed: false,\n  });\n  const listRef = useRef<HTMLDivElement>(null);\n  const handleTouchStart = (e: TouchEvent) => {\n    if (!canTouch || touchInfo.initialed) {\n      return;\n    }\n    listRef.current!.style[\"transition\"] = \"\";\n\n    setTouchInfo({\n      startY: e.nativeEvent.touches[0].pageY,\n      distance: 0,\n      initialed: true,\n    });\n  };\n  const handleTouchMove = (e: TouchEvent) => {\n    if (!canTouch || !touchInfo.initialed) {\n      return;\n    }\n    const dis = e.nativeEvent.touches[0].pageY - touchInfo.startY;\n    if (dis < 0) {\n      return;\n    }\n    setTouchInfo({ ...touchInfo, distance: dis });\n    listRef.current!.style.transform = `translate3d(0, ${dis}px, 0)`;\n  };\n  const [show, setShow] = useState(true);\n  const dispatch = useDispatch();\n\n  const handleTouchEnd = (e: TouchEvent) => {\n    console.log(canTouch);\n    if (!canTouch || !touchInfo.initialed) {\n      return;\n    }\n    if (touchInfo.distance > 150) {\n      listRef.current!.style.transition = `all .3s`;\n      setShow(false);\n    } else {\n      setTouchInfo({ startY: 0, distance: 0, initialed: false });\n      listRef.current!.style.transition = `all .3s`;\n      listRef.current!.style.transform = `translate3d(0, 0, 0)`;\n    }\n  };\n\n  const handleDeleteClick = (e: MouseEvent, idx: number) => {\n    setCanTouch(false);\n    e.stopPropagation();\n    dispatch(deleteSongAction(idx));\n  };\n\n  const onEnterCB = useCallback(() => {\n    listRef.current!.style[\"transform\"] = `translate3d(0, 100%, 0)`;\n  }, []);\n\n  const onEnteringCB = useCallback(() => {\n    listRef.current!.style[\"transition\"] = \"all 0.3s\";\n    listRef.current!.style[\"transform\"] = `translate3d(0, 0, 0)`;\n  }, []);\n\n  const onExitCB = useCallback(() => {\n    listRef.current!.style[\n      \"transform\"\n    ] = `translate3d(0, ${touchInfo.distance}px, 0)`;\n  }, [touchInfo.distance]);\n\n  const onExitingCB = useCallback(() => {\n    listRef.current!.style[\"transition\"] = \"all 0.3s\";\n    listRef.current!.style[\"transform\"] = `translate3d(0px, 100%, 0px)`;\n  }, []);\n\n  const onExitedCB = useCallback(() => {\n    listRef.current!.style[\"transform\"] = `translate3d(0px, 100%, 0px)`;\n    dispatch(changeShowSongListAction(false));\n  }, []);\n\n  return (\n    <CSSTransition\n      timeout={500}\n      in={show}\n      appear\n      classNames=\"move\"\n      onEnter={onEnterCB}\n      onEntering={onEnteringCB}\n      onExit={onExitCB}\n      onExiting={onExitingCB}\n      onExited={onExitedCB}\n    >\n      <div\n        className={styles[\"song-list\"]}\n        onClick={(e) => {\n          e.stopPropagation();\n        }}\n      >\n        <div\n          className={styles[\"mask\"]}\n          onClick={() => {\n            setShow(false);\n          }}\n        ></div>\n        <div\n          className={styles[\"list-wrap\"]}\n          ref={listRef}\n          onTouchStart={handleTouchStart}\n          onTouchMove={handleTouchMove}\n          onTouchEnd={handleTouchEnd}\n        >\n          <div className={styles[\"list-header\"]}>\n            <div className={styles[\"play-mode\"]}>\n              <span>播放列表</span>\n            </div>\n          </div>\n          <div className={styles[\"list-scroll-wrap\"]}>\n            <Scroll onScroll={handleScroll}>\n              <ul>\n                {songList.map((item, idx) => {\n                  return (\n                    <li\n                      key={item.id}\n                      className={classNames(\n                        styles[\"song-item\"],\n                        index === idx && styles[\"active\"]\n                      )}\n                    >\n                      <p>\n                        <span>\n                          {idx === index && <Icon icon=\"play-circle\"></Icon>}\n                        </span>\n\n                        {`${item.name} - ${formatSingerName(item.singers)} `}\n                      </p>\n                      <Button\n                        className={styles[\"delete\"]}\n                        btnType=\"primary\"\n                        onClick={(e) => {\n                          handleDeleteClick(e, idx);\n                        }}\n                      >\n                        <Icon icon=\"trash\"></Icon>\n                      </Button>\n                    </li>\n                  );\n                })}\n              </ul>\n            </Scroll>\n          </div>\n        </div>\n      </div>\n    </CSSTransition>\n  );\n};\n\nexport default memo(SongList);\n","import { Button, Icon } from \"collin-ui\";\nimport React, { FC, memo, useEffect, useRef, useState } from \"react\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { CSSTransition } from \"react-transition-group\";\nimport { StoreState } from \"../../store\";\nimport { Song } from \"../../typings\";\nimport { formatSongUrl } from \"../../utils/format\";\nimport styles from \"./index.module.scss\";\nimport MiniPlayer from \"./MiniPlayer\";\nimport SongList from \"./SongList\";\nimport { changePlayStatusAction } from \"./store/actions\";\n\nconst Player: FC = () => {\n  const { curIdx, songList, status, showSongList } = useSelector(\n    (state: StoreState) => ({\n      curIdx: state.player.currentIndex,\n      songList: state.player.songList,\n      status: state.player.playStatus,\n      showSongList: state.player.showSongList,\n    })\n  );\n  const dispatch = useDispatch();\n\n  const [curSong, setCurSong] = useState<Song | null>(null);\n\n  useEffect(() => {\n    if (curIdx < 0 || songList.length < 1) {\n      return;\n    }\n    setCurSong((preSong) => {\n      const newSong = songList[curIdx];\n      return preSong?.id === newSong.id ? preSong : newSong;\n    });\n    dispatch(changePlayStatusAction(true));\n  }, [songList, curIdx]);\n\n  /**\n   * 监听歌曲变化\n   */\n  useEffect(() => {\n    const audioDom = audioRef.current;\n    if (curSong && audioDom) {\n      audioDom.src = formatSongUrl(curSong.id);\n    }\n  }, [curSong]);\n\n  /**\n   * 监听歌曲状态\n   */\n  useEffect(() => {\n    const audioDom = audioRef.current;\n    if (audioDom) {\n      if (status) {\n        audioDom.play();\n      } else {\n        audioDom.pause();\n      }\n    }\n  }, [status]);\n\n  const audioRef = useRef<HTMLAudioElement>(null);\n  return (\n    <div className=\"player\">\n      <MiniPlayer song={songList[curIdx]} playStatus={status} />\n      <audio autoPlay ref={audioRef}></audio>\n      {showSongList && <SongList index={curIdx} songList={songList}></SongList>}\n    </div>\n  );\n};\n\nexport default memo(Player);\n","import React, { FC, memo, useCallback, useEffect, useRef } from \"react\";\nimport styles from \"./index.module.scss\";\nimport { CSSTransition } from \"react-transition-group\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { StoreState } from \"../../store\";\nimport { Alert } from \"collin-ui\";\nimport { toggleToastAction } from \"../../store/actions\";\nconst Toast: FC = () => {\n  const { showToast, toastText = \"\" } = useSelector((state: StoreState) => ({\n    showToast: state.toast.showToast,\n    toastText: state.toast.toastText,\n  }));\n  const dispatch = useDispatch();\n  const hideToast = useCallback(() => {\n    dispatch(toggleToastAction(false));\n  }, []);\n  const timer = useRef<NodeJS.Timeout | null>(null);\n  useEffect(() => {\n    if (showToast) {\n      timer.current = setTimeout(() => {\n        hideToast();\n      }, 2000);\n      return () => {\n        clearTimeout(Number(timer.current));\n        timer.current = null;\n      };\n    }\n  }, [showToast, hideToast]);\n  return (\n    <CSSTransition timeout={200} unmountOnExit classNames=\"drop\" in={showToast}>\n      <Alert\n        title={toastText}\n        className={styles[\"toast\"]}\n        onClose={hideToast}\n      ></Alert>\n    </CSSTransition>\n  );\n};\n\nexport default memo(Toast);\n","import React, { FC } from \"react\";\nimport { renderRoutes, RouteConfigComponentProps } from \"react-router-config\";\nimport Header from \"../../components/Header\";\nimport NavTabs from \"../../components/NavTabs\";\nimport Player from \"../../components/Player\";\nimport Toast from \"../../components/Toast\";\n\nconst HomeLayout: FC<RouteConfigComponentProps> = ({ route }) => {\n  return (\n    <>\n      <Header />\n      <NavTabs />\n      {renderRoutes(route?.routes)}\n      <Toast />\n      <Player />\n    </>\n  );\n};\n\nexport default HomeLayout;\n","import { Singer } from \"../typings\";\n\n/**\n * 格式化数量\n * @param count\n */\nexport const formatCount = (count: number): number | string | undefined => {\n  if (count < 0) return;\n  if (count >= 100000000) {\n    return (count / 100000000).toFixed(1) + \"亿\";\n  }\n  if (count >= 10000) {\n    return (count / 10000).toFixed(1) + \"万\";\n  }\n  return count;\n};\n\n/**\n * 给小于10的数字补上0\n * @param num\n */\nexport const formatNumber = (num: number): string | number => {\n  const numStr = num.toString();\n  return numStr[1] ? num : \"0\" + num;\n};\n\n/**\n * 格式化歌手名字\n * @param singerList\n */\nexport const formatSingerName = (singerList: Singer[]): string => {\n  return singerList.map((item: Singer): string => item.name).join(\" / \");\n};\n\n/**\n * 组装歌曲的url\n * @param id\n */\nexport const formatSongUrl = (id: number): string => {\n  return `https://music.163.com/song/media/outer/url?id=${id}.mp3`;\n};\n\n/**\n * 转换歌曲播放时间\n * @param interval\n */\nexport const formatPlayTime = (interval: number): string => {\n  interval = interval | 0; // 向下取整\n  const minute = (interval / 60) | 0;\n  const second = (interval % 60).toString().padStart(2, \"0\");\n  return `${minute}:${second}`;\n};\n","import BScroll, { BScrollInstance } from \"better-scroll\";\nimport React, {\n  FC,\n  forwardRef,\n  memo,\n  ReactNode,\n  useEffect,\n  useRef,\n  useState,\n} from \"react\";\nimport styles from \"./index.module.scss\";\n\nexport interface Position {\n  x: number;\n  y: number;\n}\n\nexport interface ScrollProps {\n  ref?: any;\n  direction?: \"horizontal\" | \"vertical\";\n  click?: boolean;\n  bounceTop?: boolean;\n  bounceBottom?: boolean;\n  bounceLeft?: boolean;\n  bounceRight?: boolean;\n  pullDownLoading?: boolean;\n  pullUpLoading?: boolean;\n  onScroll?: (pos: Position) => void;\n  onPullDown?: () => void;\n  onPullUp?: () => void;\n  children?: ReactNode;\n}\n\nconst Scroll: FC<ScrollProps> = forwardRef(\n  (\n    {\n      direction = \"vertical\",\n      click = true,\n      children,\n      bounceTop = true,\n      bounceBottom = true,\n      bounceLeft = true,\n      bounceRight = true,\n      pullDownLoading = false,\n      pullUpLoading = false,\n      onScroll,\n      onPullDown = () => {},\n      onPullUp = () => {},\n    },\n    ref\n  ) => {\n    const [bScroll, setBScroll] = useState<BScrollInstance | null>(null);\n    const scrollRef = useRef<HTMLDivElement>(null);\n    /**\n     * 初始化scroll\n     */\n    useEffect(() => {\n      let scroll = new BScroll(scrollRef.current!, {\n        click: click,\n        probeType: 3,\n        scrollX: direction === \"horizontal\",\n        scrollY: direction === \"vertical\",\n        tap: \"tap\",\n        bounce: {\n          top: bounceTop,\n          bottom: bounceBottom,\n          left: bounceLeft,\n          right: bounceRight,\n        },\n      });\n\n      setBScroll(scroll);\n      return () => {\n        setBScroll(null);\n      };\n    }, []);\n\n    /**\n     * 监听onScroll\n     */\n    useEffect(() => {\n      if (onScroll && bScroll) {\n        bScroll.on(\"scroll\", onScroll);\n        return () => {\n          bScroll.off(\"scroll\");\n        };\n      }\n    }, [bScroll, onScroll]);\n\n    /**\n     * 刷新scroll\n     */\n    useEffect(() => {\n      bScroll && bScroll.refresh();\n    });\n    return (\n      <div className={styles[\"scroll-wrapper\"]} ref={scrollRef}>\n        {children}\n      </div>\n    );\n  }\n);\n\nexport default memo(Scroll);\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"scroll-wrapper\":\"Scroll_scroll-wrapper__3QrgQ\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"header\":\"Header_header__MbTxY\",\"title\":\"Header_title__1F92a\",\"menu\":\"Header_menu__11t9R\",\"search\":\"Header_search__1IyxK\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"nav-tabs\":\"NavTabs_nav-tabs__24HRn\",\"actived\":\"NavTabs_actived__16j6j\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"mini-player\":\"MiniPlayer_mini-player__CeHNs\",\"img-wrap\":\"MiniPlayer_img-wrap__1-a7b\",\"spin\":\"MiniPlayer_spin__3wxhx\",\"pause\":\"MiniPlayer_pause__2kQOf\",\"text\":\"MiniPlayer_text__mXQuV\",\"name\":\"MiniPlayer_name__3TpJU\",\"singer\":\"MiniPlayer_singer__ZlG0P\",\"control\":\"MiniPlayer_control__ID-sq\",\"control-button\":\"MiniPlayer_control-button__3sNG-\",\"control-list\":\"MiniPlayer_control-list__1FU1I\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"song-list\":\"SongList_song-list__2ntge\",\"mask\":\"SongList_mask__3q32e\",\"list-wrap\":\"SongList_list-wrap__L8_cA\",\"list-header\":\"SongList_list-header__3ubwt\",\"list-scroll-wrap\":\"SongList_list-scroll-wrap__3NjPG\",\"song-item\":\"SongList_song-item__1Iid_\",\"delete\":\"SongList_delete__wU8z-\",\"active\":\"SongList_active__2fGVx\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"toast\":\"Toast_toast__14S2T\"};"],"sourceRoot":""}