{"version":3,"sources":["components/SongList/index.module.scss","components/SongList/index.tsx","utils/tools.ts","pages/Album/index.module.scss","pages/Album/index.tsx","assets/images/music.png","components/Scroll/index.tsx","components/Scroll/index.module.scss","utils/format.ts","components/Loading/index.tsx","components/Loading/index.module.scss"],"names":["module","exports","SongList","forwardRef","props","ref","recommendSongs","curId","dispatch","useDispatch","handleSongClick","idx","data","actions","changeSongListAction","JSON","parse","stringify","changeCurrentIndexAction","listRef","useRef","useImperativeHandle","play","getListDom","current","className","styles","map","songItem","debounce","placeholder","src","require","default","alt","width","height","album","picUrl","name","formatSingerName","singers","onClick","icon","id","memo","Album","useSelector","state","albumDetail","songList","player","curIdx","currentIndex","loading","params","useParams","history","useHistory","useEffect","getAlbumDetailAction","Number","wrapperStyle","flex","overflow","marginBottom","useState","show","setShow","console","log","timeout","in","unmountOnExit","classNames","onExited","goBack","appear","style","onScroll","forceCheck","coverImgUrl","creator","avatarUrl","nickname","tracks","Scroll","direction","click","children","bounceTop","bounceBottom","bounceLeft","bounceRight","pullDownLoading","pullUpLoading","restProps","onPullDown","onPullUp","bScroll","setBScroll","scrollRef","scroll","BScroll","probeType","scrollX","scrollY","tap","bounce","top","bottom","left","right","refresh","scrollTo","getBScroll","on","off","singerList","item","join","formatSongUrl","Loading"],"mappings":"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","file":"static/js/8.c739e165.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"songs-wrapper\":\"SongList_songs-wrapper__3hZnd\",\"wrapper-content\":\"SongList_wrapper-content__3Eu5K\",\"card\":\"SongList_card__14Ovo\",\"content\":\"SongList_content__1QPqV\",\"img\":\"SongList_img__1dn9V\",\"info\":\"SongList_info__2b-3g\",\"song-info\":\"SongList_song-info__2uN1B\",\"song-name\":\"SongList_song-name__16kcA\",\"play-button\":\"SongList_play-button__3Mk03\"};","import { Button, Card, CardContent, Icon } from \"collin-ui\";\nimport React, { FC, forwardRef, memo, useImperativeHandle } from \"react\";\nimport { Song } from \"../../typings\";\nimport styles from \"./index.module.scss\";\nimport { actions } from \"../Player/store\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport LazyLoad from \"react-lazyload\";\nimport { deepClone } from \"../../utils/tools\";\nimport { formatSingerName } from \"../../utils/format\";\nimport { useRef } from \"react\";\n\nexport interface SongListProps {\n  recommendSongs: Song[];\n  curId: number;\n}\n\nexport interface SongListInstance {\n  play: (idx: number) => void;\n  getListDom?: () => HTMLDivElement | null;\n}\n\nconst SongList = forwardRef((props: SongListProps, ref) => {\n  const { recommendSongs, curId } = props;\n  const dispatch = useDispatch();\n  const handleSongClick = (idx: number) => {\n    dispatch(actions.changeSongListAction(deepClone(recommendSongs)));\n    dispatch(actions.changeCurrentIndexAction(idx));\n  };\n  const listRef = useRef<HTMLDivElement>(null);\n\n  useImperativeHandle(ref, (): SongListInstance => {\n    return {\n      play: (idx) => {\n        handleSongClick(idx);\n      },\n      getListDom: () => {\n        return listRef.current;\n      },\n    };\n  });\n\n  return (\n    <div className={styles[\"songs-wrapper\"]} ref={listRef}>\n      <div className={styles[\"wrapper-content\"]}>\n        {recommendSongs.map((songItem, idx) => {\n          return (\n            <Card className={styles[\"card\"]} key={songItem.id}>\n              <CardContent className={styles[\"content\"]}>\n                <div className={styles[\"img\"]}>\n                  <LazyLoad\n                    debounce={500}\n                    placeholder={\n                      <img\n                        src={require(\"../../assets/images/music.png\").default}\n                        alt=\"music\"\n                        width=\"50\"\n                        height=\"100%\"\n                        className={styles[\"img\"]}\n                      />\n                    }\n                  >\n                    <img\n                      src={songItem.album.picUrl}\n                      alt=\"\"\n                      className={styles[\"img\"]}\n                      width=\"100%\"\n                      height=\"100%\"\n                    />\n                  </LazyLoad>\n                </div>\n                <div className={styles[\"info\"]}>\n                  <p className={styles[\"song-name\"]}>{songItem.name}</p>\n                  <p className={styles[\"song-info\"]}>\n                    {`${formatSingerName(songItem.singers)} - ${\n                      songItem.album.name\n                    }`}\n                  </p>\n                </div>\n                <Button\n                  className={styles[\"play-button\"]}\n                  onClick={() => {\n                    handleSongClick(idx);\n                  }}\n                >\n                  <Icon\n                    icon={songItem.id === curId ? \"podcast\" : \"play\"}\n                  ></Icon>\n                </Button>\n              </CardContent>\n            </Card>\n          );\n        })}\n      </div>\n    </div>\n  );\n});\n\nexport default memo(SongList);\n","export const deepClone = <T = any>(data: T): T => {\n  return JSON.parse(JSON.stringify(data));\n};\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"album-wrap\":\"Album_album-wrap__Inw_6\",\"header\":\"Album_header__3iSna\",\"detail-wrap\":\"Album_detail-wrap__3Rvru\",\"img-card\":\"Album_img-card__vWsPd\",\"content\":\"Album_content__1ybXq\",\"cover\":\"Album_cover__W-W4w\",\"info\":\"Album_info__Qh8pi\",\"title\":\"Album_title__1VhR0\",\"creator\":\"Album_creator__3WXJ2\",\"songs-wrap\":\"Album_songs-wrap__1uxYm\"};","import { Card, CardContent, Icon } from \"collin-ui\";\nimport React, { FC, memo, useEffect, useState } from \"react\";\nimport { forceCheck } from \"react-lazyload\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { useHistory, useParams } from \"react-router\";\nimport { CSSTransition } from \"react-transition-group\";\nimport Loading from \"../../components/Loading\";\nimport Scroll from \"../../components/Scroll\";\nimport SongList from \"../../components/SongList\";\nimport { StoreState } from \"../../store\";\nimport styles from \"./index.module.scss\";\nimport { getAlbumDetailAction } from \"./store/actions\";\n\nexport interface AlbumCreator {\n  avatarUrl: string;\n  nickname: string;\n}\n\nexport interface AlbumProps {\n  subscribedCount: number;\n  name: string;\n  creator: AlbumCreator;\n  coverImgUrl: string;\n}\n\nexport interface AlbumParams {\n  id: string;\n}\n\nconst Album: FC = () => {\n  const { albumDetail, songList, curIdx, loading } = useSelector(\n    (state: StoreState) => ({\n      albumDetail: state.album.albumDetail,\n      songList: state.player.songList,\n      curIdx: state.player.currentIndex,\n      loading: state.album.loading,\n    })\n  );\n\n  const params = useParams<AlbumParams>();\n  const history = useHistory();\n  const dispatch = useDispatch();\n\n  /**\n   * 获取歌单详情数据\n   */\n  useEffect((): void => {\n    dispatch(getAlbumDetailAction(Number(params.id)));\n  }, []);\n\n  const goBack = () => {\n    setShow(false);\n  };\n  const wrapperStyle = {\n    flex: 1,\n    overflow: \"hidden\",\n    marginBottom: curIdx > -1 ? \"60px\" : 0,\n  };\n  const [show, setShow] = useState(true);\n  console.log();\n\n  return (\n    <CSSTransition\n      timeout={300}\n      in={show}\n      unmountOnExit\n      classNames=\"fly\"\n      onExited={history.goBack}\n      appear\n    >\n      {\n        <div className={styles[\"album-wrap\"]}>\n          <div className={styles[\"header\"]} onClick={goBack}>\n            <Icon icon=\"chevron-left\"></Icon>\n            <h1>歌单</h1>\n          </div>\n          {!loading && (\n            <div style={wrapperStyle}>\n              {albumDetail && (\n                <Scroll onScroll={forceCheck}>\n                  <div>\n                    <div className={styles[\"detail-wrap\"]}>\n                      <Card className={styles[\"img-card\"]}>\n                        <CardContent className={styles[\"content\"]}>\n                          <img\n                            className={styles[\"cover\"]}\n                            src={albumDetail.coverImgUrl}\n                            width=\"100%\"\n                            height=\"100%\"\n                            alt=\"歌单封面\"\n                          />\n                          <div className={styles[\"info\"]}>\n                            <p className={styles[\"title\"]}>\n                              {albumDetail.name}\n                            </p>\n\n                            <div className={styles[\"creator\"]}>\n                              <img\n                                src={albumDetail.creator.avatarUrl}\n                                width=\"100%\"\n                                height=\"100%\"\n                                alt=\"歌单封面\"\n                              />\n                              <p className={styles[\"creator-name\"]}>\n                                {albumDetail.creator.nickname}\n                              </p>\n                            </div>\n                          </div>\n                        </CardContent>\n                      </Card>\n                    </div>\n                    <div className={styles[\"songs-wrap\"]}>\n                      <SongList\n                        recommendSongs={albumDetail.tracks}\n                        curId={curIdx > -1 ? songList[curIdx].id : -1}\n                      ></SongList>\n                    </div>\n                  </div>\n                </Scroll>\n              )}\n            </div>\n          )}\n          {loading && <Loading></Loading>}\n        </div>\n      }\n    </CSSTransition>\n  );\n};\n\nexport default memo(Album);\n","export default __webpack_public_path__ + \"static/media/music.6275a6ce.png\";","import BScroll, { BScrollInstance, Options } from \"better-scroll\";\nimport React, {\n  FC,\n  forwardRef,\n  memo,\n  ReactNode,\n  useEffect,\n  useImperativeHandle,\n  useRef,\n  useState,\n} from \"react\";\nimport styles from \"./index.module.scss\";\n\nexport interface Position {\n  x: number;\n  y: number;\n}\n\nexport interface ScrollProps extends Options {\n  ref?: any;\n  direction?: \"horizontal\" | \"vertical\";\n  click?: boolean;\n  bounceTop?: boolean;\n  bounceBottom?: boolean;\n  bounceLeft?: boolean;\n  bounceRight?: boolean;\n  pullDownLoading?: boolean;\n  pullUpLoading?: boolean;\n  onScroll?: (pos: Position) => void;\n  onPullDown?: () => void;\n  onPullUp?: () => void;\n  children?: ReactNode;\n}\n\nexport interface ScrollInstance {\n  refresh: () => void;\n  getBScroll: () => BScrollInstance | undefined;\n}\n\nconst Scroll: FC<ScrollProps> = forwardRef(\n  (\n    {\n      direction = \"vertical\",\n      click = true,\n      children,\n      bounceTop = true,\n      bounceBottom = true,\n      bounceLeft = true,\n      bounceRight = true,\n      pullDownLoading = false,\n      pullUpLoading = false,\n      onScroll,\n      onPullDown = () => {},\n      onPullUp = () => {},\n      ...restProps\n    },\n    ref\n  ) => {\n    const [bScroll, setBScroll] = useState<BScrollInstance | null>(null);\n    const scrollRef = useRef<HTMLDivElement>(null);\n    /**\n     * 初始化scroll\n     */\n    useEffect(() => {\n      let scroll = new BScroll(scrollRef.current!, {\n        click: click,\n        probeType: 3,\n        scrollX: direction === \"horizontal\",\n        scrollY: direction === \"vertical\",\n        tap: \"tap\",\n        bounce: {\n          top: bounceTop,\n          bottom: bounceBottom,\n          left: bounceLeft,\n          right: bounceRight,\n        },\n        ...restProps,\n      });\n\n      setBScroll(scroll);\n      return () => {\n        setBScroll(null);\n      };\n    }, []);\n\n    /**\n     * 通过 ref 暴露组件方法\n     */\n    useImperativeHandle(ref, (): ScrollInstance => {\n      return {\n        refresh() {\n          if (bScroll) {\n            bScroll.refresh();\n            bScroll.scrollTo(0, 0);\n          }\n        },\n        getBScroll() {\n          if (bScroll) {\n            return bScroll;\n          }\n        },\n      };\n    });\n\n    /**\n     * 监听onScroll\n     */\n    useEffect(() => {\n      if (onScroll && bScroll) {\n        bScroll.on(\"scroll\", onScroll);\n        return () => {\n          bScroll.off(\"scroll\");\n        };\n      }\n    }, [bScroll, onScroll]);\n\n    /**\n     * 刷新scroll\n     */\n    useEffect(() => {\n      bScroll && bScroll.refresh();\n    });\n    return (\n      <div className={styles[\"scroll-wrapper\"]} ref={scrollRef}>\n        {children}\n      </div>\n    );\n  }\n);\n\nexport default memo(Scroll);\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"scroll-wrapper\":\"Scroll_scroll-wrapper__3QrgQ\"};","import { Singer } from \"../typings\";\n\n/**\n * 格式化数量\n * @param count\n */\nexport const formatCount = (count: number): number | string | undefined => {\n  if (count < 0) return;\n  if (count >= 100000000) {\n    return (count / 100000000).toFixed(1) + \"亿\";\n  }\n  if (count >= 10000) {\n    return (count / 10000).toFixed(1) + \"万\";\n  }\n  return count;\n};\n\n/**\n * 给小于10的数字补上0\n * @param num\n */\nexport const formatNumber = (num: number): string | number => {\n  const numStr = num.toString();\n  return numStr[1] ? num : \"0\" + num;\n};\n\n/**\n * 格式化歌手名字\n * @param singerList\n */\nexport const formatSingerName = (singerList: Singer[]): string => {\n  return singerList.map((item: Singer): string => item.name).join(\" / \");\n};\n\n/**\n * 组装歌曲的url\n * @param id\n */\nexport const formatSongUrl = (id: number): string => {\n  return `https://music.163.com/song/media/outer/url?id=${id}.mp3`;\n};\n\n/**\n * 转换歌曲播放时间\n * @param interval\n */\nexport const formatPlayTime = (interval: number): string => {\n  interval = interval | 0; // 向下取整\n  const minute = (interval / 60) | 0;\n  const second = (interval % 60).toString().padStart(2, \"0\");\n  return `${minute}:${second}`;\n};\n","import { Icon } from \"collin-ui\";\nimport styles from \"./index.module.scss\";\nimport React, { FC, memo } from \"react\";\n\nconst Loading: FC = () => {\n  return (\n    <div className={styles[\"loading-wrap\"]}>\n      <Icon icon=\"spinner\" className={styles[\"loading\"]}></Icon>\n    </div>\n  );\n};\n\nexport default memo(Loading);\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"loading-wrap\":\"Loading_loading-wrap__2zic1\",\"loading\":\"Loading_loading__38WPi\",\"myScale\":\"Loading_myScale__2HXha\"};"],"sourceRoot":""}