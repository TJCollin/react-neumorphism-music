{"version":3,"sources":["components/SongList/index.module.scss","components/SongList/index.tsx","utils/tools.ts","pages/Recommend/index.module.scss","pages/Recommend/RecommendList/index.module.scss","pages/Recommend/RecommendList/index.tsx","pages/Recommend/index.tsx","assets/images/music.png","components/Scroll/index.tsx","components/Scroll/index.module.scss","utils/format.ts","components/Loading/index.tsx","components/Loading/index.module.scss"],"names":["module","exports","SongList","forwardRef","props","ref","recommendSongs","curId","dispatch","useDispatch","handleSongClick","idx","data","actions","changeSongListAction","JSON","parse","stringify","changeCurrentIndexAction","listRef","useRef","useImperativeHandle","play","getListDom","current","className","styles","map","songItem","debounce","placeholder","src","require","default","alt","width","height","album","picUrl","name","formatSingerName","singers","onClick","icon","id","memo","RecommendList","songList","item","to","getRecommendListAction","Recommend","route","useSelector","state","recommondList","recommend","recommendList","curIdx","player","currentIndex","loading","disPatch","useEffect","length","getRecommendSongsAcrion","songsScrollRef","wrapperStyle","flex","overflow","flexDirection","marginBottom","style","Scroll","onScroll","forceCheck","direction","stopPropagation","renderRoutes","routes","Loading","click","children","bounceTop","bounceBottom","bounceLeft","bounceRight","pullDownLoading","pullUpLoading","restProps","onPullDown","onPullUp","useState","bScroll","setBScroll","scrollRef","scroll","BScroll","probeType","scrollX","scrollY","tap","bounce","top","bottom","left","right","refresh","scrollTo","getBScroll","on","off","singerList","join","formatSongUrl"],"mappings":"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","file":"static/js/6.ddc31ac5.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"songs-wrapper\":\"SongList_songs-wrapper__3hZnd\",\"wrapper-content\":\"SongList_wrapper-content__3Eu5K\",\"card\":\"SongList_card__14Ovo\",\"content\":\"SongList_content__1QPqV\",\"img\":\"SongList_img__1dn9V\",\"info\":\"SongList_info__2b-3g\",\"song-info\":\"SongList_song-info__2uN1B\",\"song-name\":\"SongList_song-name__16kcA\",\"play-button\":\"SongList_play-button__3Mk03\"};","import { Button, Card, CardContent, Icon } from \"collin-ui\";\nimport React, { FC, forwardRef, memo, useImperativeHandle } from \"react\";\nimport { Song } from \"../../typings\";\nimport styles from \"./index.module.scss\";\nimport { actions } from \"../Player/store\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport LazyLoad from \"react-lazyload\";\nimport { deepClone } from \"../../utils/tools\";\nimport { formatSingerName } from \"../../utils/format\";\nimport { useRef } from \"react\";\n\nexport interface SongListProps {\n  recommendSongs: Song[];\n  curId: number;\n}\n\nexport interface SongListInstance {\n  play: (idx: number) => void;\n  getListDom?: () => HTMLDivElement | null;\n}\n\nconst SongList = forwardRef((props: SongListProps, ref) => {\n  const { recommendSongs, curId } = props;\n  const dispatch = useDispatch();\n  const handleSongClick = (idx: number) => {\n    dispatch(actions.changeSongListAction(deepClone(recommendSongs)));\n    dispatch(actions.changeCurrentIndexAction(idx));\n  };\n  const listRef = useRef<HTMLDivElement>(null);\n\n  useImperativeHandle(ref, (): SongListInstance => {\n    return {\n      play: (idx) => {\n        handleSongClick(idx);\n      },\n      getListDom: () => {\n        return listRef.current;\n      },\n    };\n  });\n\n  return (\n    <div className={styles[\"songs-wrapper\"]} ref={listRef}>\n      <div className={styles[\"wrapper-content\"]}>\n        {recommendSongs.map((songItem, idx) => {\n          return (\n            <Card className={styles[\"card\"]} key={songItem.id}>\n              <CardContent className={styles[\"content\"]}>\n                <div className={styles[\"img\"]}>\n                  <LazyLoad\n                    debounce={500}\n                    placeholder={\n                      <img\n                        src={require(\"../../assets/images/music.png\").default}\n                        alt=\"music\"\n                        width=\"50\"\n                        height=\"100%\"\n                        className={styles[\"img\"]}\n                      />\n                    }\n                  >\n                    <img\n                      src={songItem.album.picUrl}\n                      alt=\"\"\n                      className={styles[\"img\"]}\n                      width=\"100%\"\n                      height=\"100%\"\n                    />\n                  </LazyLoad>\n                </div>\n                <div className={styles[\"info\"]}>\n                  <p className={styles[\"song-name\"]}>{songItem.name}</p>\n                  <p className={styles[\"song-info\"]}>\n                    {`${formatSingerName(songItem.singers)} - ${\n                      songItem.album.name\n                    }`}\n                  </p>\n                </div>\n                <Button\n                  className={styles[\"play-button\"]}\n                  onClick={() => {\n                    handleSongClick(idx);\n                  }}\n                >\n                  <Icon\n                    icon={songItem.id === curId ? \"podcast\" : \"play\"}\n                  ></Icon>\n                </Button>\n              </CardContent>\n            </Card>\n          );\n        })}\n      </div>\n    </div>\n  );\n});\n\nexport default memo(SongList);\n","export const deepClone = <T = any>(data: T): T => {\n  return JSON.parse(JSON.stringify(data));\n};\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"recomm-wrap\":\"Recommend_recomm-wrap__2Hb0-\",\"title\":\"Recommend_title__24VAr\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"wrapper-content\":\"RecommendList_wrapper-content__38vmC\",\"card-wrapper\":\"RecommendList_card-wrapper__QlZrD\",\"img-card\":\"RecommendList_img-card__2omPq\",\"img\":\"RecommendList_img__2JFjY\",\"desc\":\"RecommendList_desc__3qnT2\"};","import { Card } from \"collin-ui\";\nimport React, { FC, memo, useEffect, useRef } from \"react\";\nimport { Recomm } from \"../../../typings\";\nimport styles from \"./index.module.scss\";\nimport LazyLoad, { forceCheck } from \"react-lazyload\";\nimport Scroll from \"../../../components/Scroll\";\nimport { Link } from \"react-router-dom\";\nexport interface RecommendListProps {\n  songList: Recomm[];\n}\n\nconst RecommendList: FC<RecommendListProps> = (props) => {\n  const { songList } = props;\n\n  return (\n    <div className={styles[\"wrapper-content\"]}>\n      {songList.map((item) => {\n        return (\n          <Link\n            to={`/recommend/${item.id}`}\n            className={styles[\"card-wrapper\"]}\n            key={item.id}\n          >\n            <Card className={styles[\"img-card\"]}>\n              <LazyLoad\n                debounce={500}\n                placeholder={\n                  <img\n                    src={require(\"../../../assets/images/music.png\").default}\n                    alt=\"music\"\n                    width=\"50\"\n                    height=\"100%\"\n                    className={styles[\"img\"]}\n                  />\n                }\n              >\n                <img\n                  src={item.picUrl}\n                  alt=\"\"\n                  className={styles[\"img\"]}\n                  width=\"100%\"\n                  height=\"100%\"\n                />\n              </LazyLoad>\n            </Card>\n            <p className={styles[\"desc\"]}>{item.name}</p>\n          </Link>\n        );\n      })}\n    </div>\n  );\n};\n\nexport default memo(RecommendList);\n","import { CSSProperties, FC, useEffect, useRef } from \"react\";\nimport styles from \"./index.module.scss\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { StoreState } from \"../../store\";\nimport { actions } from \"./store\";\nimport { forceCheck } from \"react-lazyload\";\nimport { getRecommendSongsAcrion } from \"./store/actions\";\nimport SongList from \"../../components/SongList\";\nimport RecommendList from \"./RecommendList\";\nimport Scroll from \"../../components/Scroll\";\nimport Loading from \"../../components/Loading\";\nimport { renderRoutes, RouteConfigComponentProps } from \"react-router-config\";\nconst { getRecommendListAction } = actions;\n\nconst Recommend: FC<RouteConfigComponentProps> = ({ route }) => {\n  const { recommondList, recommendSongs, curIdx, loading } = useSelector(\n    (state: StoreState) => {\n      return {\n        recommondList: state.recommend.recommendList,\n        recommendSongs: state.recommend.recommendSongs,\n        curIdx: state.player.currentIndex,\n        loading: state.recommend.loading,\n      };\n    }\n  );\n  const disPatch = useDispatch();\n  useEffect(() => {\n    !recommondList.length && disPatch(getRecommendListAction(6));\n    !recommendSongs.length && disPatch(getRecommendSongsAcrion());\n  }, []);\n\n  const songsScrollRef = useRef<HTMLDivElement>(null);\n\n  const wrapperStyle: CSSProperties = {\n    flex: 1,\n    overflow: \"hidden\",\n    flexDirection: \"column\",\n    marginBottom: curIdx > -1 ? \"60px\" : 0,\n  };\n\n  return (\n    <div style={wrapperStyle} className={styles[\"recomm-wrap\"]}>\n      <Scroll ref={songsScrollRef} onScroll={forceCheck}>\n        <div>\n          <h5 className={styles[\"title\"]}>推荐歌单</h5>\n          <Scroll direction=\"horizontal\" onScroll={forceCheck} stopPropagation>\n            <RecommendList songList={recommondList} />\n          </Scroll>\n          <h5 className={styles[\"title\"]}>推荐歌曲</h5>\n          <SongList\n            recommendSongs={recommendSongs}\n            curId={curIdx > -1 ? recommendSongs[curIdx].id : -1}\n          />\n        </div>\n      </Scroll>\n      {renderRoutes(route?.routes)}\n      {loading && <Loading />}\n    </div>\n  );\n};\nexport default Recommend;\n","export default __webpack_public_path__ + \"static/media/music.6275a6ce.png\";","import BScroll, { BScrollInstance, Options } from \"better-scroll\";\nimport React, {\n  FC,\n  forwardRef,\n  memo,\n  ReactNode,\n  useEffect,\n  useImperativeHandle,\n  useRef,\n  useState,\n} from \"react\";\nimport styles from \"./index.module.scss\";\n\nexport interface Position {\n  x: number;\n  y: number;\n}\n\nexport interface ScrollProps extends Options {\n  ref?: any;\n  direction?: \"horizontal\" | \"vertical\";\n  click?: boolean;\n  bounceTop?: boolean;\n  bounceBottom?: boolean;\n  bounceLeft?: boolean;\n  bounceRight?: boolean;\n  pullDownLoading?: boolean;\n  pullUpLoading?: boolean;\n  onScroll?: (pos: Position) => void;\n  onPullDown?: () => void;\n  onPullUp?: () => void;\n  children?: ReactNode;\n}\n\nexport interface ScrollInstance {\n  refresh: () => void;\n  getBScroll: () => BScrollInstance | undefined;\n}\n\nconst Scroll: FC<ScrollProps> = forwardRef(\n  (\n    {\n      direction = \"vertical\",\n      click = true,\n      children,\n      bounceTop = true,\n      bounceBottom = true,\n      bounceLeft = true,\n      bounceRight = true,\n      pullDownLoading = false,\n      pullUpLoading = false,\n      onScroll,\n      onPullDown = () => {},\n      onPullUp = () => {},\n      ...restProps\n    },\n    ref\n  ) => {\n    const [bScroll, setBScroll] = useState<BScrollInstance | null>(null);\n    const scrollRef = useRef<HTMLDivElement>(null);\n    /**\n     * 初始化scroll\n     */\n    useEffect(() => {\n      let scroll = new BScroll(scrollRef.current!, {\n        click: click,\n        probeType: 3,\n        scrollX: direction === \"horizontal\",\n        scrollY: direction === \"vertical\",\n        tap: \"tap\",\n        bounce: {\n          top: bounceTop,\n          bottom: bounceBottom,\n          left: bounceLeft,\n          right: bounceRight,\n        },\n        ...restProps,\n      });\n\n      setBScroll(scroll);\n      return () => {\n        setBScroll(null);\n      };\n    }, []);\n\n    /**\n     * 通过 ref 暴露组件方法\n     */\n    useImperativeHandle(ref, (): ScrollInstance => {\n      return {\n        refresh() {\n          if (bScroll) {\n            bScroll.refresh();\n            bScroll.scrollTo(0, 0);\n          }\n        },\n        getBScroll() {\n          if (bScroll) {\n            return bScroll;\n          }\n        },\n      };\n    });\n\n    /**\n     * 监听onScroll\n     */\n    useEffect(() => {\n      if (onScroll && bScroll) {\n        bScroll.on(\"scroll\", onScroll);\n        return () => {\n          bScroll.off(\"scroll\");\n        };\n      }\n    }, [bScroll, onScroll]);\n\n    /**\n     * 刷新scroll\n     */\n    useEffect(() => {\n      bScroll && bScroll.refresh();\n    });\n    return (\n      <div className={styles[\"scroll-wrapper\"]} ref={scrollRef}>\n        {children}\n      </div>\n    );\n  }\n);\n\nexport default memo(Scroll);\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"scroll-wrapper\":\"Scroll_scroll-wrapper__3QrgQ\"};","import { Singer } from \"../typings\";\n\n/**\n * 格式化数量\n * @param count\n */\nexport const formatCount = (count: number): number | string | undefined => {\n  if (count < 0) return;\n  if (count >= 100000000) {\n    return (count / 100000000).toFixed(1) + \"亿\";\n  }\n  if (count >= 10000) {\n    return (count / 10000).toFixed(1) + \"万\";\n  }\n  return count;\n};\n\n/**\n * 给小于10的数字补上0\n * @param num\n */\nexport const formatNumber = (num: number): string | number => {\n  const numStr = num.toString();\n  return numStr[1] ? num : \"0\" + num;\n};\n\n/**\n * 格式化歌手名字\n * @param singerList\n */\nexport const formatSingerName = (singerList: Singer[]): string => {\n  return singerList.map((item: Singer): string => item.name).join(\" / \");\n};\n\n/**\n * 组装歌曲的url\n * @param id\n */\nexport const formatSongUrl = (id: number): string => {\n  return `https://music.163.com/song/media/outer/url?id=${id}.mp3`;\n};\n\n/**\n * 转换歌曲播放时间\n * @param interval\n */\nexport const formatPlayTime = (interval: number): string => {\n  interval = interval | 0; // 向下取整\n  const minute = (interval / 60) | 0;\n  const second = (interval % 60).toString().padStart(2, \"0\");\n  return `${minute}:${second}`;\n};\n","import { Icon } from \"collin-ui\";\nimport styles from \"./index.module.scss\";\nimport React, { FC, memo } from \"react\";\n\nconst Loading: FC = () => {\n  return (\n    <div className={styles[\"loading-wrap\"]}>\n      <Icon icon=\"spinner\" className={styles[\"loading\"]}></Icon>\n    </div>\n  );\n};\n\nexport default memo(Loading);\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"loading-wrap\":\"Loading_loading-wrap__2zic1\",\"loading\":\"Loading_loading__38WPi\",\"myScale\":\"Loading_myScale__2HXha\"};"],"sourceRoot":""}